import{r as c,I as ee,o as te,l as r,c as f,a as d,b as t,f as s,w as l,e as M,F as T,d as W,m as i,t as P,J as ae,g as k,n as R,p as se,y as le,q as N,s as u,H as oe}from"./vendor-HcLblEBu.js";import{_ as ne}from"./index-DLbMR7kT.js";const re={class:"page-container"},ie={class:"header-left"},de={class:"sbox-editor"},ue={class:"side-list"},ce={class:"list-container"},pe=["onClick"],ve={class:"editor-main"},me={class:"form-header"},_e={class:"form-group name-group"},fe={class:"visualization"},ge={class:"grid-container"},ye=["title"],xe={class:"form-group flex-grow"},be={class:"actions"},we={key:1,style:{display:"flex",gap:"10px",width:"100%"}},Se={class:"appearance-editor"},ke={class:"setting-item"},Ce={class:"wallpaper-upload"},he=["src"],Ve={class:"upload-hint"},Be={class:"setting-item"},Ie={class:"setting-label"},Ne={class:"value-text"},Ae={class:"slider-container"},Ee={class:"about-section"},ze={__name:"SettingsPage",setup(De){const g=c([]),m=c(""),p=c(""),_=c(""),v=c(!1),C=c(!0),h=c(!0),V=c(""),w=c(.3),y=c(""),L=ee(()=>{try{let a=_.value.replace(/[\[\]\s]/g,"");if(a.includes(","))return _.value.replace(/[\[\]]/g,"").split(",").map(e=>e.trim()).filter(e=>e!=="");{let e=[];for(let n=0;n<a.length;n+=2)e.push(a.substring(n,n+2));return e}}catch{return[]}}),B=async(a=5)=>{try{const e=await N.get("http://127.0.0.1:3335/api/sbox/names");g.value=e.data.names,g.value.length>0&&!m.value&&I(g.value[0])}catch(e){console.error("Load SBox Names failed, retrying...",e),a>0&&setTimeout(()=>B(a-1),500)}},I=async a=>{m.value=a;try{const e=await N.get(`http://127.0.0.1:3335/api/sbox/get/${encodeURIComponent(a)}`);p.value=e.data.name,_.value=e.data.content,v.value=e.data.is_standard}catch{u.error("Failed to load S-box")}},Q=()=>{m.value="",p.value="New S-Box",_.value="",v.value=!1},G=()=>{const a=p.value;m.value="",p.value=a+"_Copy",v.value=!1,u.success("已克隆配置")},U=async()=>{var a,e;if(!p.value)return u.warning("名称不能为空");try{await N.post("http://127.0.0.1:3335/api/sbox/save",{name:p.value,content:_.value}),u.success("保存成功"),await B(),I(p.value)}catch(n){u.error("保存失败: "+(((e=(a=n.response)==null?void 0:a.data)==null?void 0:e.detail)||n.message))}},H=async()=>{if(!v.value)try{await oe.confirm(`确定要删除 ${m.value} 吗?`,"警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}),await N.delete(`http://127.0.0.1:3335/api/sbox/delete/${encodeURIComponent(m.value)}`),u.success("删除成功"),await B(),g.value.length>0&&I(g.value[0])}catch(a){a!=="cancel"&&u.error("删除失败")}},O=a=>{const e=new FileReader;return e.onload=n=>{const x=n.target.result;if(x.length>5*1024*1024*1.37){u.error("图片大小不能超过 5MB");return}V.value=x,y.value=x,A()},e.readAsDataURL(a.raw),!1},q=()=>{V.value="",y.value="",A()},A=()=>{try{localStorage.setItem("terminal_bg_image",V.value),localStorage.setItem("terminal_bg_opacity",w.value),window.dispatchEvent(new Event("storage")),u.success("外观设置已保存")}catch(a){console.error("Save settings failed:",a),a.name==="QuotaExceededError"?u.error("保存失败：图片太大超过了存储限制，请使用更小的图片"):u.error("保存设置失败")}},J=()=>{const a=localStorage.getItem("terminal_bg_image"),e=localStorage.getItem("terminal_bg_opacity");a&&(V.value=a,y.value=a),e!==null&&(w.value=parseFloat(e))};return te(()=>{B(),J()}),(a,e)=>{const n=r("el-tag"),x=r("ArrowDown"),S=r("el-icon"),$=r("Plus"),b=r("el-button"),F=r("el-input"),j=r("CopyDocument"),K=r("el-alert"),E=r("el-card"),X=r("el-upload"),Y=r("el-slider"),z=r("el-descriptions-item"),Z=r("el-descriptions");return d(),f("div",re,[e[27]||(e[27]=t("h1",null,"设置",-1)),s(E,{class:"section-card","body-style":{padding:"0px"}},{header:l(()=>[t("div",{class:"section-header",onClick:e[0]||(e[0]=o=>C.value=!C.value)},[t("div",ie,[e[7]||(e[7]=t("h2",null,"配置 S盒 (S-Box Configuration)",-1)),v.value?(d(),k(n,{key:0,type:"success",size:"small",effect:"dark",round:""},{default:l(()=>[...e[5]||(e[5]=[i("标准 (Static)",-1)])]),_:1})):(d(),k(n,{key:1,type:"primary",size:"small",effect:"dark",round:""},{default:l(()=>[...e[6]||(e[6]=[i("自定义 (Custom)",-1)])]),_:1}))]),s(S,{class:"expand-icon",style:R({transform:C.value?"rotate(180deg)":"rotate(0deg)"})},{default:l(()=>[s(x)]),_:1},8,["style"])])]),default:l(()=>[t("div",{class:M(["sbox-editor-wrapper",{collapsed:!C.value}])},[t("div",de,[t("div",ue,[t("div",ce,[(d(!0),f(T,null,W(g.value,o=>(d(),f("div",{key:o,class:M(["list-item",{active:m.value===o,is_standard:o.startsWith("Standard")}]),onClick:D=>I(o)},[e[8]||(e[8]=t("span",{class:"dot"},null,-1)),i(" "+P(o),1)],10,pe))),128))]),s(b,{class:"add-btn",onClick:Q,plain:"",type:"primary",size:"small",style:{width:"100%","margin-top":"10px"}},{default:l(()=>[s(S,null,{default:l(()=>[s($)]),_:1}),e[9]||(e[9]=i(" 新建 S盒 ",-1))]),_:1})]),t("div",ve,[t("div",me,[t("div",_e,[e[11]||(e[11]=t("span",{class:"input-label"},"配置名称:",-1)),s(F,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),readonly:v.value,placeholder:"输入S盒名称"},ae({_:2},[v.value?void 0:{name:"append",fn:l(()=>[s(b,{onClick:U},{default:l(()=>[...e[10]||(e[10]=[i("保存",-1)])]),_:1})]),key:"0"}]),1032,["modelValue","readonly"])]),s(b,{onClick:G,size:"small"},{default:l(()=>[s(S,null,{default:l(()=>[s(j)]),_:1}),e[12]||(e[12]=i(" 克隆 ",-1))]),_:1})]),t("div",fe,[e[13]||(e[13]=t("span",{class:"input-label"},"矩阵视图 (16x16 Grid):",-1)),t("div",ge,[(d(!0),f(T,null,W(L.value,(o,D)=>(d(),f("div",{key:D,class:"grid-cell",title:`Index: ${D}`},P(o.length===2?o:("0"+o).slice(-2)),9,ye))),128))])]),t("div",xe,[e[14]||(e[14]=t("span",{class:"input-label"},"原始数据 (Hex Stream):",-1)),s(F,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=o=>_.value=o),readonly:v.value,type:"textarea",rows:4,resize:"none",placeholder:"例如: d690e9fe..."},null,8,["modelValue","readonly"])]),t("div",be,[v.value?(d(),k(K,{key:0,title:"标准S盒不可直接修改，请克隆后编辑",type:"warning","show-icon":"",closable:!1,style:{width:"100%"}})):(d(),f("div",we,[s(b,{type:"primary",onClick:U,style:{flex:"1"}},{default:l(()=>[...e[15]||(e[15]=[i("保存配置",-1)])]),_:1}),s(b,{type:"danger",plain:"",onClick:H},{default:l(()=>[...e[16]||(e[16]=[i("删除此配置",-1)])]),_:1})]))])])])],2)]),_:1}),s(E,{class:"section-card","body-style":{padding:"0px"}},{header:l(()=>[t("div",{class:"section-header",onClick:e[3]||(e[3]=o=>h.value=!h.value)},[e[17]||(e[17]=t("div",{class:"header-left"},[t("h2",null,"终端外观 (Terminal Appearance)")],-1)),s(S,{class:"expand-icon",style:R({transform:h.value?"rotate(180deg)":"rotate(0deg)"})},{default:l(()=>[s(x)]),_:1},8,["style"])])]),default:l(()=>[t("div",{class:M(["sbox-editor-wrapper",{collapsed:!h.value}])},[t("div",Se,[t("div",ke,[e[20]||(e[20]=t("div",{class:"setting-label"},"背景图片 (Wallpaper)",-1)),t("div",Ce,[s(X,{class:"avatar-uploader","show-file-list":!1,"auto-upload":!1,"on-change":O,accept:"image/*"},{default:l(()=>[y.value?(d(),f("img",{key:0,src:y.value,class:"avatar"},null,8,he)):(d(),k(S,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[s($)]),_:1}))]),_:1}),t("div",Ve,[e[19]||(e[19]=t("p",null,"点击上传图片 (最大 5MB)",-1)),y.value?(d(),k(b,{key:0,type:"danger",link:"",onClick:le(q,["stop"])},{default:l(()=>[...e[18]||(e[18]=[i("清除壁纸",-1)])]),_:1})):se("",!0)])])]),t("div",Be,[t("div",Ie,[e[21]||(e[21]=i(" 背景不透明度 (Opacity) ",-1)),t("span",Ne,P(Math.round(w.value*100))+"%",1)]),t("div",Ae,[s(Y,{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=o=>w.value=o),min:0,max:1,step:.05,"show-input":"",onChange:A},null,8,["modelValue"])])])])],2)]),_:1}),t("div",Ee,[s(E,{class:"about-card"},{header:l(()=>[...e[22]||(e[22]=[t("div",{class:"about-header"},[t("h2",null,"关于 Descrypt Pro")],-1)])]),default:l(()=>[e[26]||(e[26]=t("p",null,"由于不会写解密脚本于是用AI搓了一个奇怪小玩意。受 CyberChef 启发，基于 Electron 和 FastAPI 构建。",-1)),s(Z,{column:3,border:""},{default:l(()=>[s(z,{label:"版本"},{default:l(()=>[...e[23]||(e[23]=[i("0.0.1",-1)])]),_:1}),s(z,{label:"驱动"},{default:l(()=>[...e[24]||(e[24]=[i("QAQ",-1)])]),_:1}),s(z,{label:"状态"},{default:l(()=>[s(n,{type:"success"},{default:l(()=>[...e[25]||(e[25]=[i("运行中",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])])}}},Ue=ne(ze,[["__scopeId","data-v-66daf6d8"]]);export{Ue as default};
