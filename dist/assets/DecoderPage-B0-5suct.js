import{r as k,o as J,c as d,a as o,b as t,f as a,w as n,l as u,m as T,g as I,p as i,e as L,q as S,s as A,F as C,d as E,t as M,u as q,v as j}from"./vendor-HcLblEBu.js";import{_ as Q}from"./index-DLbMR7kT.js";const Y={class:"decoder-container"},Z={class:"palette-col"},ee={class:"palette-content"},ae={class:"category-label"},le=["onClick"],se={class:"recipe-col"},te={class:"col-header lighting-effect"},oe={class:"recipe-content"},de={key:0,class:"empty-recipe"},ne={class:"recipe-item-header"},re={class:"header-left"},ie={class:"item-label"},pe={class:"item-actions"},ue={key:0,class:"item-params"},ce={key:0,class:"param-row"},_e={key:1,class:"param-row"},me={key:2,class:"param-row"},ye={key:3,class:"param-row"},ve={key:4,class:"param-row"},fe={key:5,class:"param-row"},be={key:6,class:"param-row"},ke={key:7,class:"param-row"},he={key:8,class:"param-row"},Ve={key:9,class:"hint-text",style:{"font-size":"11px",color:"#909399","margin-top":"4px","line-height":"1.4"}},ge={key:0},we={key:1},xe={key:10,class:"hint-text",style:{"font-size":"11px",color:"#909399","margin-top":"4px","line-height":"1.4"}},Ue={class:"work-col"},Se={class:"section input-section"},Ce={class:"section-header lighting-effect"},Ee={class:"controls"},Be={class:"section output-section"},ze={class:"section-header lighting-effect"},Fe={class:"controls"},Te={__name:"DecoderPage",setup(Ie){const g=k(""),w=k(""),v=k("UTF-8"),B=k("UTF-8"),m=k("无分隔符"),V=k(!0),N=k(["Standard AES","Standard SM4"]),f=k([]),O=[{category:"编码 / 解码",ops:[{id:"base64_encode",label:"Base64 编码"},{id:"base64_decode",label:"Base64 解码"},{id:"base32_encode",label:"Base32 编码"},{id:"base32_decode",label:"Base32 解码"},{id:"base16_encode",label:"Base16 编码"},{id:"base16_decode",label:"Base16 解码"},{id:"base85_encode",label:"Base85 编码"},{id:"base85_decode",label:"Base85 解码"},{id:"url_encode",label:"URL 编码"},{id:"url_decode",label:"URL 解码"},{id:"html_encode",label:"HTML 编码"},{id:"html_decode",label:"HTML 解码"},{id:"unicode_encode",label:"Unicode 编码"},{id:"unicode_decode",label:"Unicode 解码"}]},{category:"哈希 / 摘要",ops:[{id:"md5_hash",label:"MD5 哈希",params:{output_format:"hex"}}]},{category:"加密 / 解密",ops:[{id:"rc4_encrypt",label:"RC4 加密",params:{key:"secret",key_type:"utf-8",swap_bytes:!1,sbox_name:"Standard RC4"}},{id:"rc4_decrypt",label:"RC4 解密",params:{key:"secret",key_type:"utf-8",swap_bytes:!1,sbox_name:"Standard RC4"}},{id:"des_encrypt",label:"DES 加密",params:{key:"12345678",mode:"ECB",padding:"pkcs7",key_type:"utf-8",iv_type:"utf-8"}},{id:"des_decrypt",label:"DES 解密",params:{key:"12345678",mode:"ECB",padding:"pkcs7",key_type:"utf-8",iv_type:"utf-8"}},{id:"triple_des_encrypt",label:"3DES 加密",params:{key:"123456781234567812345678",mode:"ECB",padding:"pkcs7",key_type:"utf-8",iv_type:"utf-8"}},{id:"triple_des_decrypt",label:"3DES 解密",params:{key:"123456781234567812345678",mode:"ECB",padding:"pkcs7",key_type:"utf-8",iv_type:"utf-8"}},{id:"aes_encrypt",label:"AES 加密",params:{key:"1234567890123456",iv:"",mode:"CBC",padding:"pkcs7",sbox_name:"Standard AES",key_type:"utf-8",iv_type:"utf-8",swap_key_schedule:!1,swap_data_round:!1}},{id:"aes_decrypt",label:"AES 解密",params:{key:"1234567890123456",iv:"",mode:"CBC",padding:"pkcs7",sbox_name:"Standard AES",key_type:"utf-8",iv_type:"utf-8",swap_key_schedule:!1,swap_data_round:!1}},{id:"sm4_encrypt",label:"SM4 加密",params:{key:"1234567890123456",iv:"",mode:"ECB",padding:"pkcs7",sbox_name:"Standard SM4",key_type:"utf-8",iv_type:"utf-8",swap_key_schedule:!1,swap_data_round:!1}},{id:"sm4_decrypt",label:"SM4 解密",params:{key:"1234567890123456",iv:"",mode:"ECB",padding:"pkcs7",sbox_name:"Standard SM4",key_type:"utf-8",iv_type:"utf-8",swap_key_schedule:!1,swap_data_round:!1}}]}],X=async(p=5)=>{try{const l=await S.get("http://127.0.0.1:3335/api/sbox/names");N.value=l.data.names}catch(l){console.error("Load SBox Names failed, retrying...",l),p>0&&setTimeout(()=>X(p-1),500)}},P=p=>{f.value.push({...p,instanceId:Date.now()+Math.random(),enabled:!0,params:p.params?JSON.parse(JSON.stringify(p.params)):{}})},K=p=>{f.value.splice(p,1)},$=async()=>{var p,l;try{let c=g.value,b=!1;if(v.value==="HEX"&&f.value.length>0){const _=f.value[0].id;["aes_encrypt","aes_decrypt","sm4_encrypt","sm4_decrypt","des_encrypt","des_decrypt","triple_des_encrypt","triple_des_decrypt","rc4_encrypt","rc4_decrypt"].includes(_)&&(b=!0)}!b&&(v.value!=="UTF-8"||m.value!=="无分隔符")&&(c=(await S.post("http://127.0.0.1:3335/api/utils/convert_format",{data:c,from_fmt:v.value,to_fmt:"UTF-8",separator:m.value==="无分隔符"?"":m.value==="空格"?" ":m.value})).data.result);const D=f.value.filter(_=>_.enabled!==!1).map((_,F)=>{const h={name:_.id,params:{..._.params}};return F===0&&b&&v.value==="HEX"&&(h.params.data_type="hex"),h});let x=(await S.post("http://127.0.0.1:3335/api/pipeline/run",{data:c,operations:D})).data.result;B.value!=="UTF-8"&&(x=(await S.post("http://127.0.0.1:3335/api/utils/convert_format",{data:x,from_fmt:"UTF-8",to_fmt:B.value})).data.result),w.value=x,A.success("执行成功")}catch(c){console.error("Execute Recipe Error:",c),w.value=`[Error] ${((l=(p=c.response)==null?void 0:p.data)==null?void 0:l.detail)||c.message}`,c.message==="Network Error"&&(w.value+=" (Check if Python backend is running on 127.0.0.1:3335)"),A.error("执行出错")}},W=async()=>{try{V.value=!V.value;const p=await S.post("http://127.0.0.1:3335/api/utils/endian_swap",{data:g.value,from_fmt:v.value,to_fmt:"",separator:m.value==="无分隔符"?"":m.value==="空格"?" ":m.value});g.value=p.data.result,A.success(`切换为 ${V.value?"Big Endian":"Little Endian"}`)}catch(p){console.error(p)}};return J(()=>{X()}),(p,l)=>{const c=u("Plus"),b=u("el-icon"),R=u("el-scrollbar"),D=u("VideoPlay"),z=u("el-button"),x=u("Grid"),_=u("el-switch"),F=u("Close"),h=u("el-input"),r=u("el-option"),y=u("el-select"),H=u("el-checkbox"),G=u("el-card");return o(),d("div",Y,[t("div",Z,[l[6]||(l[6]=t("div",{class:"col-header lighting-effect"},"操作列表",-1)),t("div",ee,[a(R,null,{default:n(()=>[(o(),d(C,null,E(O,e=>t("div",{key:e.category,class:"category-group"},[t("div",ae,M(e.category),1),(o(!0),d(C,null,E(e.ops,U=>(o(),d("div",{key:U.id,class:"op-item",onClick:s=>P(U)},[T(M(U.label)+" ",1),a(b,{class:"plus"},{default:n(()=>[a(c)]),_:1})],8,le))),128))])),64))]),_:1})])]),t("div",se,[t("div",te,[l[8]||(l[8]=T(" 编码链 (Operation Chain) ",-1)),a(z,{type:"primary",size:"small",onClick:$,round:""},{default:n(()=>[l[7]||(l[7]=T(" 执行 ",-1)),a(b,{class:"el-icon--right"},{default:n(()=>[a(D)]),_:1})]),_:1})]),t("div",oe,[a(R,null,{default:n(()=>[f.value.length===0?(o(),d("div",de," 点击左侧操作以添加到链中 ")):i("",!0),a(q(j),{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),"item-key":"instanceId",handle:".drag-handle",class:"drag-list"},{item:n(({element:e,index:U})=>[a(G,{class:L(["recipe-item",{disabled:e.enabled===!1}]),"body-style":{padding:"0px"}},{default:n(()=>[t("div",ne,[t("div",re,[a(b,{class:"drag-handle"},{default:n(()=>[a(x)]),_:1}),t("span",ie,M(e.label),1)]),t("div",pe,[a(_,{modelValue:e.enabled,"onUpdate:modelValue":s=>e.enabled=s,size:"small",style:{"margin-right":"8px"}},null,8,["modelValue","onUpdate:modelValue"]),a(z,{link:"",type:"danger",size:"small",onClick:s=>K(U)},{default:n(()=>[a(b,null,{default:n(()=>[a(F)]),_:1})]),_:1},8,["onClick"])])]),e.params&&e.enabled!==!1?(o(),d("div",ue,[e.params.key!==void 0?(o(),d("div",ce,[l[9]||(l[9]=t("span",{class:"param-label"},"Key:",-1)),a(h,{modelValue:e.params.key,"onUpdate:modelValue":s=>e.params.key=s,size:"small",placeholder:"Key",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),e.params.key_type!==void 0?(o(),I(y,{key:0,modelValue:e.params.key_type,"onUpdate:modelValue":s=>e.params.key_type=s,size:"small",style:{width:"85px"}},{default:n(()=>[a(r,{label:"UTF-8",value:"utf-8"}),a(r,{label:"HEX",value:"hex"})]),_:1},8,["modelValue","onUpdate:modelValue"])):i("",!0)])):i("",!0),e.params.iv!==void 0?(o(),d("div",_e,[l[10]||(l[10]=t("span",{class:"param-label"},"IV:",-1)),a(h,{modelValue:e.params.iv,"onUpdate:modelValue":s=>e.params.iv=s,size:"small",placeholder:"IV",style:{flex:"1"}},null,8,["modelValue","onUpdate:modelValue"]),e.params.iv_type!==void 0?(o(),I(y,{key:0,modelValue:e.params.iv_type,"onUpdate:modelValue":s=>e.params.iv_type=s,size:"small",style:{width:"85px"}},{default:n(()=>[a(r,{label:"UTF-8",value:"utf-8"}),a(r,{label:"HEX",value:"hex"})]),_:1},8,["modelValue","onUpdate:modelValue"])):i("",!0)])):i("",!0),e.params.mode!==void 0?(o(),d("div",me,[l[11]||(l[11]=t("span",{class:"param-label"},"Mode:",-1)),a(y,{modelValue:e.params.mode,"onUpdate:modelValue":s=>e.params.mode=s,size:"small",style:{width:"100%"}},{default:n(()=>[(o(),d(C,null,E(["ECB","CBC","CFB","OFB","CTR"],s=>a(r,{key:s,label:s,value:s},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue"])])):i("",!0),e.params.padding!==void 0?(o(),d("div",ye,[l[12]||(l[12]=t("span",{class:"param-label"},"Padding:",-1)),a(y,{modelValue:e.params.padding,"onUpdate:modelValue":s=>e.params.padding=s,size:"small",style:{width:"100%"}},{default:n(()=>[(o(),d(C,null,E(["pkcs7","zeropadding","iso10126","ansix923","nopadding"],s=>a(r,{key:s,label:s,value:s},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue"])])):i("",!0),e.params.output_format!==void 0?(o(),d("div",ve,[l[13]||(l[13]=t("span",{class:"param-label"},"Format:",-1)),a(y,{modelValue:e.params.output_format,"onUpdate:modelValue":s=>e.params.output_format=s,size:"small",style:{width:"100%"}},{default:n(()=>[a(r,{label:"HEX",value:"hex"}),a(r,{label:"Base64",value:"base64"})]),_:1},8,["modelValue","onUpdate:modelValue"])])):i("",!0),e.params.sbox_name!==void 0?(o(),d("div",fe,[l[14]||(l[14]=t("span",{class:"param-label"},"S-Box:",-1)),a(y,{modelValue:e.params.sbox_name,"onUpdate:modelValue":s=>e.params.sbox_name=s,size:"small",style:{width:"100%"}},{default:n(()=>[(o(!0),d(C,null,E(N.value,s=>(o(),I(r,{key:s,label:s,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])])):i("",!0),e.params.swap_key_schedule!==void 0?(o(),d("div",be,[a(H,{modelValue:e.params.swap_key_schedule,"onUpdate:modelValue":s=>e.params.swap_key_schedule=s,label:"Swap Key Schedule (Magic)",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):i("",!0),e.params.swap_data_round!==void 0?(o(),d("div",ke,[a(H,{modelValue:e.params.swap_data_round,"onUpdate:modelValue":s=>e.params.swap_data_round=s,label:"Swap Data Round (Magic)",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):i("",!0),e.params.swap_bytes!==void 0?(o(),d("div",he,[a(H,{modelValue:e.params.swap_bytes,"onUpdate:modelValue":s=>e.params.swap_bytes=s,label:"Swap Bytes (Magic RC4)",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):i("",!0),e.id.startsWith("sm4")||e.id.startsWith("aes")?(o(),d("div",Ve,[e.params.swap_key_schedule?(o(),d("div",ge,"ℹ️ Swap Key: 在密钥扩展阶段交换S盒输出 (字节序翻转)")):i("",!0),e.params.swap_data_round?(o(),d("div",we,"ℹ️ Swap Data: 在加密轮函数中交换S盒输出/列 (字节序翻转)")):i("",!0)])):i("",!0),e.id.startsWith("rc4")&&e.params.swap_bytes?(o(),d("div",xe,[...l[15]||(l[15]=[t("div",null,"ℹ️ Swap Bytes: KSA阶段交换S盒元素时改变异或逻辑",-1)])])):i("",!0)])):i("",!0)]),_:2},1032,["class"])]),_:1},8,["modelValue"])]),_:1})])]),t("div",Ue,[t("div",Se,[t("div",Ce,[l[16]||(l[16]=t("span",null,"输入 (Input)",-1)),t("div",Ee,[a(y,{modelValue:v.value,"onUpdate:modelValue":l[1]||(l[1]=e=>v.value=e),size:"small",style:{width:"90px"}},{default:n(()=>[a(r,{label:"UTF-8",value:"UTF-8"}),a(r,{label:"HEX",value:"HEX"}),a(r,{label:"ASCII",value:"ASCII"})]),_:1},8,["modelValue"]),v.value==="HEX"?(o(),I(y,{key:0,modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=e=>m.value=e),size:"small",style:{width:"100px"}},{default:n(()=>[a(r,{label:"无分隔符",value:"无分隔符"}),a(r,{label:"空格",value:"空格"}),a(r,{label:"0x",value:"0x"}),a(r,{label:"\\x",value:"\\x"})]),_:1},8,["modelValue"])):i("",!0),a(z,{size:"small",class:L(["endian-btn",{be:V.value,le:!V.value}]),onClick:W},{default:n(()=>[T(M(V.value?"BE":"LE"),1)]),_:1},8,["class"])])]),a(h,{modelValue:g.value,"onUpdate:modelValue":l[3]||(l[3]=e=>g.value=e),type:"textarea",placeholder:"在此输入数据...",resize:"none",class:"io-textarea"},null,8,["modelValue"])]),t("div",Be,[t("div",ze,[l[17]||(l[17]=t("span",null,"输出 (Output)",-1)),t("div",Fe,[a(y,{modelValue:B.value,"onUpdate:modelValue":l[4]||(l[4]=e=>B.value=e),size:"small",style:{width:"90px"}},{default:n(()=>[a(r,{label:"UTF-8",value:"UTF-8"}),a(r,{label:"HEX",value:"HEX"}),a(r,{label:"ASCII",value:"ASCII"})]),_:1},8,["modelValue"])])]),a(h,{modelValue:w.value,"onUpdate:modelValue":l[5]||(l[5]=e=>w.value=e),type:"textarea",readonly:"",placeholder:"处理结果...",resize:"none",class:"io-textarea"},null,8,["modelValue"])])])])}}},De=Q(Te,[["__scopeId","data-v-7a18836d"]]);export{De as default};
